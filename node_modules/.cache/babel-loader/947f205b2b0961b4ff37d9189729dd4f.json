{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\SHYA\\\\Desktop\\\\blog\\\\src\\\\containers\\\\writing\\\\writing.jsx\",\n    _dec,\n    _class;\n\nimport React, { Component } from 'react';\nimport RichTextEditor from './rich_text_editor';\nimport { Link } from 'react-router-dom';\nimport { getSort, updateSort, addText } from '../../api';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { nanoid } from 'nanoid';\nimport './writing.less';\nimport { connect } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  Option\n} = _Select;\nlet Writing = (_dec = connect(state => ({\n  user: state.userInfo\n}), {}), _dec(_class = class Writing extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      showAdd: false,\n      sort: [],\n      visible: false,\n      titleValue: '',\n      sendSort: ''\n    };\n\n    this.addSort = () => {\n      this.setState({\n        showAdd: !this.state.showAdd\n      });\n    };\n\n    this.valueRef = /*#__PURE__*/React.createRef();\n\n    this.submit = async () => {\n      //获取输入内容\n      const value = this.valueRef.current.state.value;\n\n      if (value === undefined) {} else {\n        if (!value.trim()) {\n          _message.info('输入不能为空！', 0.5);\n        } else {\n          //console.log(value.trim()+'---');\n          //发送添加分类的请求\n          let sortArr = this.state.sort; //let oldLength = sortArr.length\n\n          sortArr.unshift(value.trim()); //console.log(sortArr);\n\n          let result = await updateSort(this.props.user.id, sortArr);\n\n          if (result) {\n            // let newLength = sortArr.length\n            // newLength>oldLength?\n            _message.success('添加成功', 1); //:(message.error('添加失败',1)\n\n\n            this.setState({}); //)\n          } else {\n            _message.error('添加失败', 1);\n\n            this.setState({\n              sort: []\n            });\n          } //关闭输入框\n\n\n          this.setState({\n            showAdd: !this.state.showAdd\n          });\n        }\n      }\n    };\n\n    this.titleValue = event => {};\n\n    this.cancel = () => {\n      this.setState({\n        showAdd: !this.state.showAdd\n      });\n    };\n\n    this.sortValue = event => {\n      let value = event.target.innerHTML;\n\n      if (value.length <= 10) {\n        console.log(value);\n      } else {} //console.log(event.target.innerHTML);\n\n    };\n\n    this.handleChange = value => {\n      //console.log(`selected ${value}`);\n      this.setState({\n        sendSort: value\n      });\n    };\n\n    this.publish = () => {\n      //console.log('dian le ');\n      this.setState({\n        visible: true\n      });\n    };\n\n    this.handleOk = async e => {\n      //console.log(e);\n      this.setState({\n        visible: false\n      });\n      const username = this.props.user.username;\n      const {\n        sendSort: sort,\n        titleValue: title\n      } = this.state;\n\n      if (sort) {\n        if (title) {\n          let text = this.RichText.getRichText(); // console.log(username);\n          // console.log(sort);\n          // console.log(title);\n          // console.log(text);\n          //发送添加文章的请求\n\n          let result = await addText(title, username, sort, text);\n\n          if (result !== undefined) {\n            _message.success('发表成功', 1);\n\n            console.log(result);\n          } else {\n            _message.info('网络差，请稍后再试！', 1);\n          }\n        } else {}\n      } else {\n        _message.info('分类是必选的！', 1);\n      }\n    };\n\n    this.handleCancel = e => {\n      //console.log(e);\n      this.setState({\n        visible: false\n      });\n    };\n\n    this.onFinish = values => {\n      this.setState({\n        visible: true\n      });\n      this.setState({\n        titleValue: values.title\n      }); //console.log('Success:', values);\n    };\n  }\n\n  //组件挂载后发送请求获取用户的分类\n  async componentDidMount() {\n    //console.log(this.props.user.id);\n    let result = await getSort(this.props.user.id); //console.log(result)\n\n    if (result !== undefined) {\n      if (result.status === 0) {\n        const {\n          sort\n        } = result.data;\n        this.setState({\n          sort\n        });\n      } else {\n        _message.warning('当前网络差，请稍后再试');\n      }\n    } else {}\n  } //新建分类的回调\n\n\n  render() {\n    const {\n      sort\n    } = this.state; //console.log(this.state.sort); \n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"writing_div\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"writing_left\",\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          to: \"/home\",\n          children: /*#__PURE__*/_jsxDEV(_Button, {\n            className: \"writing_left_home\",\n            type: \"primary\",\n            shape: \"round\",\n            size: \"large\",\n            ghost: \"true\",\n            children: \"\\u56DE\\u9996\\u9875\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: this.addSort,\n          style: {\n            color: 'white',\n            fontSize: \"15px\",\n            outline: 'none',\n            backgroundColor: '#373737',\n            border: 'none'\n          },\n          children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 21\n          }, this), \"\\u65B0\\u5EFA\\u5206\\u7C7B\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: this.state.showAdd ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(_Input, {\n              ref: this.valueRef,\n              style: {\n                backgroundColor: '#595959',\n                marginTop: '10px',\n                marginBottom: '12px',\n                color: 'white'\n              },\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5206\\u7C7B\\u540D...\",\n              maxLength: \"10\",\n              bordered: false,\n              size: \"large\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(_Button, {\n              onClick: this.submit,\n              type: \"primary\",\n              shape: \"round\",\n              size: \"middle\",\n              ghost: \"true\",\n              style: {\n                color: '\t #33cc00',\n                borderColor: '\t #33cc00'\n              },\n              children: \"\\u63D0\\u4EA4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(_Button, {\n              onClick: this.cancel,\n              style: {\n                color: '#999999',\n                marginLeft: '10px'\n              },\n              type: \"link\",\n              children: \"\\u53D6\\u6D88\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 44\n          }, this) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: this.sortValue,\n          className: \"sort_div\",\n          children: sort ? sort.map(a => {\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"sort_div_li\",\n              children: a\n            }, nanoid(), false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 40\n            }, this);\n          }) : null\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"writing_editor\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"editor_h1\",\n          children: \"\\u6807\\u9898\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(_Form, {\n          onFinish: this.onFinish,\n          children: [/*#__PURE__*/_jsxDEV(_Form.Item, {\n            name: \"title\",\n            rules: [{\n              required: true,\n              message: '标题不能为空!'\n            }, {\n              max: 30,\n              message: '标题最多为30位!'\n            }, {\n              pattern: /^[^\\s]*$/,\n              message: '标题不能含空格'\n            }],\n            children: /*#__PURE__*/_jsxDEV(_Input, {\n              size: \"large\",\n              autoComplete: \"off\",\n              placeholder: \"\\u5728\\u6B64\\u8F93\\u5165\\u6807\\u9898\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"editor_h2\",\n            children: \"\\u5206\\u7C7B\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(_Select, {\n            defaultValue: \"--\\u9009\\u62E9\\u5206\\u7C7B--\",\n            style: {\n              width: '100%'\n            },\n            onChange: this.handleChange,\n            children: sort ? sort.map(a => {\n              return /*#__PURE__*/_jsxDEV(Option, {\n                value: a,\n                children: a\n              }, nanoid(), false, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 40\n              }, this);\n            }) : null\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(_Form.Item, {\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"editor_h3\",\n              children: [\"\\u6B63\\u6587\", /*#__PURE__*/_jsxDEV(_Button, {\n                //onClick={this.publish}\n                htmlType: \"submit\",\n                type: \"primary\",\n                ghost: true,\n                style: {\n                  width: '120px',\n                  float: 'right',\n                  marginRight: '10px'\n                },\n                shape: \"round\",\n                size: 'large',\n                children: \"\\u53D1\\u8868\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 21\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(_Modal, {\n          title: \"\\u63D0\\u793A\",\n          visible: this.state.visible,\n          onOk: this.handleOk,\n          onCancel: this.handleCancel,\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u786E\\u5B9A\\u53D1\\u8868\\u5417\\uFF1F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"editor\",\n          children: /*#__PURE__*/_jsxDEV(RichTextEditor, {\n            ref: c => this.RichText = c\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }, this);\n  }\n\n}) || _class);\nexport default Writing;","map":{"version":3,"sources":["C:/Users/SHYA/Desktop/blog/src/containers/writing/writing.jsx"],"names":["React","Component","RichTextEditor","Link","getSort","updateSort","addText","PlusOutlined","nanoid","connect","Option","Writing","state","user","userInfo","showAdd","sort","visible","titleValue","sendSort","addSort","setState","valueRef","createRef","submit","value","current","undefined","trim","info","sortArr","unshift","result","props","id","success","error","event","cancel","sortValue","target","innerHTML","length","console","log","handleChange","publish","handleOk","e","username","title","text","RichText","getRichText","handleCancel","onFinish","values","componentDidMount","status","data","warning","render","color","fontSize","outline","backgroundColor","border","marginTop","marginBottom","borderColor","marginLeft","map","a","required","message","max","pattern","width","float","marginRight","c"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport RichTextEditor from './rich_text_editor'\r\nimport {Link} from 'react-router-dom'\r\nimport {Button,Input,message,Select,Modal,Form} from 'antd'\r\nimport {getSort,updateSort,addText} from '../../api'\r\nimport {PlusOutlined} from '@ant-design/icons';\r\nimport {nanoid} from 'nanoid'\r\nimport './writing.less'\r\nimport { connect } from 'react-redux'\r\nconst { Option } = Select;\r\n\r\n@connect(\r\n    state=>({user:state.userInfo}),\r\n    {}\r\n)\r\nclass Writing extends Component {\r\n    state={\r\n        showAdd:false,\r\n        sort:[],\r\n        visible:false,\r\n        titleValue:'',\r\n        sendSort:''\r\n    }\r\n\r\n    //组件挂载后发送请求获取用户的分类\r\n    async componentDidMount (){\r\n        //console.log(this.props.user.id);\r\n        let result = await getSort(this.props.user.id)\r\n        //console.log(result)\r\n        if(result!==undefined){\r\n            if(result.status===0){\r\n                const {sort} = result.data\r\n                this.setState({sort})\r\n            }else {\r\n                message.warning('当前网络差，请稍后再试')\r\n            }\r\n        }else{}\r\n        \r\n        \r\n    }\r\n\r\n    //新建分类的回调\r\n    addSort = () => {\r\n        this.setState({showAdd:!this.state.showAdd})\r\n    }\r\n    valueRef = React.createRef()\r\n    //提交按钮回调\r\n    submit = async() => {\r\n        //获取输入内容\r\n        const value = this.valueRef.current.state.value\r\n        if(value===undefined){}else{\r\n            if(!value.trim()){\r\n                message.info('输入不能为空！',0.5)\r\n            }else{\r\n                //console.log(value.trim()+'---');\r\n                //发送添加分类的请求\r\n                let sortArr = this.state.sort\r\n                //let oldLength = sortArr.length\r\n                sortArr.unshift(value.trim())\r\n                //console.log(sortArr);\r\n                let result = await updateSort(this.props.user.id,sortArr)\r\n                if(result){\r\n                    // let newLength = sortArr.length\r\n                    // newLength>oldLength?\r\n                    message.success('添加成功',1)\r\n                    //:(message.error('添加失败',1)\r\n                    this.setState({})\r\n                    //)\r\n                }else{\r\n                    message.error('添加失败',1)\r\n                    this.setState({sort:[]})\r\n                }\r\n                \r\n                //关闭输入框\r\n                this.setState({showAdd:!this.state.showAdd})\r\n            }\r\n        }\r\n    }\r\n    //标题的回调\r\n    titleValue = (event) => {\r\n        \r\n    }\r\n    //取消的回调\r\n    cancel = () => {\r\n        this.setState({showAdd:!this.state.showAdd})\r\n    }\r\n    //点击分类按钮的回调\r\n    sortValue = (event) => {\r\n        let value = event.target.innerHTML\r\n        if(value.length<=10){\r\n            console.log(value);\r\n        }else{}\r\n        //console.log(event.target.innerHTML);\r\n    }\r\n    //分类下拉框的回调\r\n    handleChange = (value) => {\r\n        //console.log(`selected ${value}`);\r\n        this.setState({sendSort:value})\r\n    }\r\n    //发表按钮回调\r\n    publish = () => {\r\n        //console.log('dian le ');\r\n        this.setState({\r\n            visible: true,\r\n        });\r\n    }\r\n    handleOk = async e => {\r\n        //console.log(e);\r\n        this.setState({\r\n          visible: false,\r\n        });\r\n        const username =this.props.user.username\r\n        const {sendSort:sort,titleValue:title} = this.state\r\n        if(sort){\r\n            if(title){\r\n                let text = this.RichText.getRichText()\r\n                // console.log(username);\r\n                // console.log(sort);\r\n                // console.log(title);\r\n                // console.log(text);\r\n                //发送添加文章的请求\r\n                let result =await addText(title,username,sort,text)\r\n                if(result!==undefined){\r\n                    message.success('发表成功',1)\r\n                    console.log(result);\r\n                }else{message.info('网络差，请稍后再试！',1)}\r\n                \r\n            }else{}\r\n        }else{message.info('分类是必选的！',1)}\r\n    };\r\n    handleCancel = e => {\r\n        //console.log(e);\r\n        this.setState({\r\n          visible: false,\r\n        });\r\n    };\r\n    onFinish = (values) => {\r\n        this.setState({\r\n            visible: true,\r\n        })\r\n        this.setState({titleValue:values.title})\r\n      //console.log('Success:', values);\r\n    };\r\n    \r\n   \r\n    render() {\r\n        const {sort} = this.state\r\n        //console.log(this.state.sort); \r\n        return (\r\n            <div className=\"writing_div\">\r\n                <div className=\"writing_left\">\r\n                    <Link to=\"/home\">\r\n                    <Button className=\"writing_left_home\" type=\"primary\" shape=\"round\"  size='large' ghost='true'>\r\n                        回首页\r\n                    </Button></Link>\r\n                    <button onClick={this.addSort}\r\n                     style={{color:'white', fontSize:\"15px\",outline:'none',backgroundColor:'#373737',border:'none'}}>\r\n                    <PlusOutlined/>新建分类</button>\r\n                    <div>\r\n                    {\r\n                        this.state.showAdd?<div>\r\n                            <Input \r\n                            ref={this.valueRef}\r\n                            style={{backgroundColor:'#595959',marginTop:'10px',marginBottom:'12px',color:'white'}} \r\n                            placeholder=\"请输入分类名...\" \r\n                            maxLength=\"10\"\r\n                            bordered= {false}\r\n                            size='large'/>\r\n                            <Button \r\n                            onClick={this.submit}\r\n                            type=\"primary\" shape=\"round\" size='middle' ghost='true'\r\n                            style={{color:'\t #33cc00',borderColor:'\t #33cc00'}}>\r\n                            提交</Button>\r\n                            <Button onClick={this.cancel} style={{color:'#999999',marginLeft:'10px'}} type=\"link\">取消</Button>\r\n                        </div>:null\r\n                    }\r\n                    </div>\r\n                    <div onClick={this.sortValue} className=\"sort_div\">\r\n                        {\r\n                            sort?\r\n                            sort.map((a) => {\r\n                                return <li className='sort_div_li' key={nanoid()}>{a}</li>\r\n                            }):null\r\n                        }\r\n                    </div>\r\n                </div>\r\n                <div className='writing_editor'>\r\n                    <h1 className='editor_h1'>标题</h1>\r\n                    <Form\r\n                       onFinish={this.onFinish}\r\n                    >\r\n                    <Form.Item\r\n                        name=\"title\"\r\n                        rules={[{ required: true, message: '标题不能为空!' },\r\n                                {max:30,message: '标题最多为30位!',},\r\n                                {pattern:/^[^\\s]*$/,message: '标题不能含空格'},]}\r\n                    >\r\n                    <Input size=\"large\" autoComplete=\"off\" placeholder=\"在此输入标题\"/>\r\n                    </Form.Item>\r\n\r\n                    <h2 className='editor_h2'>分类</h2> \r\n                    <Select defaultValue=\"--选择分类--\" style={{ width: '100%' }} onChange={this.handleChange}>\r\n                        {   \r\n                            sort?\r\n                            sort.map((a) => {\r\n                                return <Option key={nanoid()} value={a}>{a}</Option>\r\n                            }):null\r\n                        }\r\n                        \r\n                    </Select>\r\n                    <Form.Item >\r\n                    <h3 className='editor_h3'>正文\r\n                    <Button\r\n                     //onClick={this.publish}\r\n                     htmlType=\"submit\"\r\n                     type=\"primary\" ghost={true}\r\n                     style={{width:'120px',float:'right',marginRight:'10px'}} \r\n                     shape=\"round\" size={'large'}>发表</Button>\r\n                    </h3> </Form.Item>\r\n                    </Form>\r\n                    <Modal\r\n                        title=\"提示\"\r\n                        visible={this.state.visible}\r\n                        onOk={this.handleOk}\r\n                        onCancel={this.handleCancel}\r\n                        >\r\n                        <p>确定发表吗？</p>\r\n                    </Modal>\r\n                    <div className='editor'><RichTextEditor ref={c=>this.RichText=c} /></div>\r\n                    \r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\nexport default Writing"]},"metadata":{},"sourceType":"module"}